<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BranchEd - Visual Story Editor</title>
    <link rel="icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <header id="toolbar">
            <div class="toolbar-section">
                <button id="add-lane-btn">Add Lane</button>
                <button id="add-passage-btn">Add Passage</button>
            </div>
            <div class="toolbar-section">
                <button id="search-btn" title="Search (Ctrl+K or Cmd+K)">🔍 Search</button>
                <select id="project-selector" title="Select Project">
                    <option value="">📁 Select Project...</option>
                </select>
                <button id="import-btn">Import Twee</button>
                <button id="export-btn">Export Twee</button>
                <button id="clear-storage-btn" title="Clear Local Storage">🗑️ Clear</button>
                <button id="theme-toggle" title="Toggle Day/Night Mode">🌙</button>
            </div>
        </header>

        <div id="canvas-container">
            <canvas id="main-canvas"></canvas>
        </div>

        <div id="editor-panel" class="hidden">
            <div class="editor-header">
                <h3>Edit Passage</h3>
                <button id="close-editor">×</button>
            </div>
            <div class="editor-body">
                <input type="text" id="passage-title" placeholder="Passage Title">
                <input type="text" id="passage-tags" placeholder="Tags (space-separated, e.g. $start $lane:Anna scene1)">
                <textarea id="passage-content" placeholder="Passage content..." class="content-with-links"></textarea>
                <button id="goto-parent">Go to Parent Passage</button>
                <button id="delete-passage">Delete Passage</button>
            </div>
        </div>

        <input type="file" id="file-input" accept=".tw,.twee" style="display: none;">
        <input type="file" id="project-file-input" accept=".json" style="display: none;">
        <input type="file" id="project-folder-input" webkitdirectory directory multiple style="display: none;">


        <!-- Search Overlay -->
        <div id="search-overlay" class="search-overlay hidden">
            <div class="search-modal">
                <div class="search-header">
                    <input type="text" id="search-input" placeholder="Search passages, tags, content..." autofocus>
                    <button id="close-search" class="search-close">×</button>
                </div>
                <div class="search-results" id="search-results">
                    <!-- Results will be inserted here -->
                </div>
                <div class="search-footer">
                    <span class="search-hint">↑↓ Navigate</span>
                    <span class="search-hint">Enter Open</span>
                    <span class="search-hint">Esc Close</span>
                </div>
            </div>
        </div>
    </div>

    <script src="swimlanes.js"></script>
    <script src="editor.js"></script>
    <script src="search.js"></script>
    <script src="app.js"></script>
</body>
</html>